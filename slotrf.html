<!DOCTYPE html>
<html>
<head>
	<title>Slot ex</title>
	
	<style type="text/css">

		#canvas1{
			background-color: red;
		}
		#canvas2{
			background-color: green;
		}
		#canvas3{
			background-color: red;
		}
		#canvas4{
			background-color: green;
		}
		#canvas5{
			background-color: gray;
		}
	</style>
</head>
<body>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script type="text/javascript">
		
	//solving AnimationFrame
		(function() {
   			 var lastTime = 0;
   			 var vendors = ['ms', 'moz', 'webkit', 'o'];
   			 for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
   			     window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];
   			     window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame']
   			                                || window[vendors[x]+'CancelRequestAnimationFrame'];
   			 }
 		
 		   		if (!window.requestAnimationFrame)
 		   		    window.requestAnimationFrame = function(callback, element) {
 		   		        var currTime = new Date().getTime();
 		   		        var timeToCall = Math.max(0, 16 - (currTime - lastTime));
 		   		        var id = window.setTimeout(function() { callback(currTime + timeToCall); },
 		   		          timeToCall);
 		   		        lastTime = currTime + timeToCall;
 		   		        return id;
 		   		    };
 		
 		   		if (!window.cancelAnimationFrame)
 		   		    window.cancelAnimationFrame = function(id) {
    		        clearTimeout(id);
       		};
		}());
	//..................

		window.onload = init;

		var imgsrc = ['https://cdn4.iconfinder.com/data/icons/flat-icon-set/2133/flat_icons-graficheria.it-13.png','https://cdn0.iconfinder.com/data/icons/flat-designed-circle-icon/1000/mouse.png',
		'http://www.myiconfinder.com/uploads/iconsets/256-256-5e2a8fe966bf6f56fc29234d1e5817b8.png',
		'http://img09.deviantart.net/1da9/i/2012/206/4/f/watermelon_puke_rainbows_by_snowdrop_the_kitty-d58ku1w.png',
		'http://www.idplabs.com/wp-content/uploads/2011/03/hospital-icon.png',
		'http://www.plazaeventosbodas.com/images/icon-black-phone.png'];

		var distA = [0,150,300,450,600,-150];
		var distB = [150,600,450,0,-150,300];
		var distC = [-150,450,0,300,600,150];
		var distD = [600,-150,150,0,450,300];
		var distE = [450,300,150,-150,0,600];

		img1 = new Image();
		img2 = new Image();
		img3 = new Image();
		img4 = new Image();
		img5 = new Image();
		img6 = new Image();

		img1.src = imgsrc[0];
		img2.src = imgsrc[1];
		img3.src = imgsrc[2];
		img4.src = imgsrc[3];
		img5.src = imgsrc[4];
		img6.src = imgsrc[5];

		var reel1 = 70;
		var reel2 = 70;
		var reel3 = 70;
		var reel4 = 70;
		var reel5 = 70;

		var size = 150;
		distLeft = 180;
		var reels = 0; 
		var animating1;

		function draw1(){
			var canvas1 = document.getElementById('canvas1').getContext("2d");

			canvas1.clearRect(0,0,900,450);
			canvas1.save();

			canvas1.drawImage(img1,distLeft*0,distA[0],size,size);
			canvas1.drawImage(img2,distLeft*0,distA[1],size,size);
			canvas1.drawImage(img3,distLeft*0,distA[2],size,size);
			canvas1.drawImage(img4,distLeft*0,distA[3],size,size);
			canvas1.drawImage(img5,distLeft*0,distA[4],size,size);
			canvas1.drawImage(img6,distLeft*0,distA[5],size,size);

			canvas1.drawImage(img1,distLeft*1,distB[0],size,size);
			canvas1.drawImage(img2,distLeft*1,distB[1],size,size);
			canvas1.drawImage(img3,distLeft*1,distB[2],size,size);
			canvas1.drawImage(img4,distLeft*1,distB[3],size,size);
			canvas1.drawImage(img5,distLeft*1,distB[4],size,size);
			canvas1.drawImage(img6,distLeft*1,distB[5],size,size);

			canvas1.drawImage(img1,distLeft*2,distC[0],size,size);
			canvas1.drawImage(img2,distLeft*2,distC[1],size,size);
			canvas1.drawImage(img3,distLeft*2,distC[2],size,size);
			canvas1.drawImage(img4,distLeft*2,distC[3],size,size);
			canvas1.drawImage(img5,distLeft*2,distC[4],size,size);
			canvas1.drawImage(img6,distLeft*2,distC[5],size,size);

			canvas1.drawImage(img1,distLeft*3,distD[0],size,size);
			canvas1.drawImage(img2,distLeft*3,distD[1],size,size);
			canvas1.drawImage(img3,distLeft*3,distD[2],size,size);
			canvas1.drawImage(img4,distLeft*3,distD[3],size,size);
			canvas1.drawImage(img5,distLeft*3,distD[4],size,size);
			canvas1.drawImage(img6,distLeft*3,distD[5],size,size);

			canvas1.drawImage(img1,distLeft*4,distE[0],size,size);
			canvas1.drawImage(img2,distLeft*4,distE[1],size,size);
			canvas1.drawImage(img3,distLeft*4,distE[2],size,size);
			canvas1.drawImage(img4,distLeft*4,distE[3],size,size);
			canvas1.drawImage(img5,distLeft*4,distE[4],size,size);
			canvas1.drawImage(img6,distLeft*4,distE[5],size,size);
			
			update(distA,reel1);
			update(distB,reel2);
			update(distC,reel3);
			update(distD,reel4);
			update(distE, reel5);

			canvas1.restore();
			
			if ($('#canvas1').hasClass('working')) {
				animating1 = window.requestAnimationFrame(draw1);
			};
		}

		function update(dist, reel){
			for(var i = 0; i < dist.length; i++){
				if (dist[i] >= 751){
					dist[i] = 0
				}else{
					dist[i] += reel;
				}
			}
		}

		function init() {
			draw1();
			reels = 0;
			reel1 = 70;
			reel2 = 70;
			reel3 = 70;
			reel4 = 70;
			reel5 = 70;
		}

		function animating(){
			animating1 = window.requestAnimationFrame(draw1);
			$('#canvas1').toggleClass('working');
			setTimeout('stopAnimation1();', getTime());
			setTimeout('stopAnimation2();', getTime());
			setTimeout('stopAnimation3();', getTime());
			setTimeout('stopAnimation4();', getTime());
			setTimeout('stopAnimation5();', getTime());

			console.log('click');
		}

		function doItWork(){
			if ($('#canvas1').hasClass('working')) {
				animating1 = window.requestAnimationFrame(draw1);
			};
		}

		function stopAnimation1(){
			reel1 = 0;
			reels ++;
			for(var i = 0; i < distA.length; i++){
				coef = Math.round(distA[i]/150);				
				distA[i] += (150*coef)-distA[i];
			}
			reelsMotion();
		}

		function stopAnimation2(){
			reel2 = 0;
			reels ++;
			for(var i = 0; i < distB.length; i++){
				coef = Math.round(distB[i]/150);				
				distB[i] += (150*coef)-distB[i];
			}
			reelsMotion();
		}

		function stopAnimation3(){
			reel3 = 0;
			reels ++;
			for(var i = 0; i < distC.length; i++){
				coef = Math.round(distC[i]/150);				
				distC[i] += (150*coef)-distC[i];
			}
			reelsMotion();
		}

		function stopAnimation4(){
			reel4 = 0;
			reels ++;
			for(var i = 0; i < distD.length; i++){
				coef = Math.round(distD[i]/150);				
				distD[i] += (150*coef)-distD[i];
			}
			reelsMotion();
		}

		function stopAnimation5(){
			reel5 = 0;
			reels ++;
			for(var i = 0; i < distE.length; i++){
				coef = Math.round(distE[i]/150);				
				distE[i] += (150*coef)-distE[i];
			}
			reelsMotion();
		}

		function reelsMotion(){
			if (reels === 5) {
				$('#canvas1').toggleClass('working');
				cancelAnimationFrame(animating1);
				init();	
			};
		}

		function getTime(){
			return Math.floor(Math.random()*2000)+1000;
		}

		$(document).on('click','#play',animating);
		
	</script>

	<canvas id="canvas1" width="900px" height="450px" >Get chrome</canvas>
	<span id="play">PLAY</span>
	
</body>

</html>